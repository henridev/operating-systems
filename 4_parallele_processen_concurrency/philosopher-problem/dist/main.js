(()=>{"use strict";var e,t,r,o,i,n,s={920:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.drawFork=t.drawPhilosopher=t.drawPhilosopherSelection=void 0;var o=r(601),i=r(928),n=r(844);t.drawPhilosopherSelection=function(e,t,r){void 0===r&&(r="green"),n.drawCircleStroke(e,{x:t.coords.x,y:t.coords.y,radius:o.RADIUS_PHILOSOPHER,border:r})},t.drawPhilosopher=function(e,t){n.drawCircle(e,{x:t.coords.x,y:t.coords.y,radius:o.RADIUS_PHILOSOPHER,color:t.color,border:i.getBorderColor(t),text:t.name+" "+t.priority})},t.drawFork=function(e,t,r){var i,s;void 0===r&&(r="black"),n.drawCircle(e,{x:t.coords.x,y:t.coords.y,radius:o.RADIUS_FORK,color:null!==(s=null===(i=t.heldBy)||void 0===i?void 0:i.color)&&void 0!==s?s:r,border:"white",text:"fork "+t.i})}},844:function(e,t,r){var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.clearCanvas=t.drawTable=t.drawCircle=t.drawCircleStroke=void 0;var i=r(601);t.drawCircleStroke=function(e,t){var r=t.x,o=t.y,i=t.radius,n=t.border;e.beginPath(),e.arc(r,o,i,0,2*Math.PI,!1),e.lineWidth=5,e.strokeStyle=n,e.stroke()},t.drawCircle=function(e,t){var r=t.x,o=t.y,i=t.radius,n=t.color,s=t.border,l=t.text;e.beginPath(),e.font="8pt Calibri",e.fillStyle="white",e.textAlign="center",e.fillText(l,r,o+3),e.arc(r,o,i,0,2*Math.PI,!1),e.fillStyle=n,e.fill(),e.lineWidth=5,e.strokeStyle=s,e.stroke()},t.drawTable=function(e,r){t.drawCircle(e,o({x:i.centerX,y:i.centerY,radius:i.R,color:"blue",border:"black",text:"philosophers table"},r))},t.clearCanvas=function(e){e.clearRect(0,0,i.CANVAS_WIDTH,i.CANVAS_HEIGHT)}},601:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.centerY=t.centerX=t.CANVAS_HEIGHT=t.CANVAS_WIDTH=t.RADIUS_PHILOSOPHER=t.RADIUS_FORK=t.R=void 0,t.R=150,t.RADIUS_FORK=20,t.RADIUS_PHILOSOPHER=30,t.CANVAS_WIDTH=500,t.CANVAS_HEIGHT=500,t.centerX=t.CANVAS_WIDTH/2,t.centerY=t.CANVAS_HEIGHT/2},1:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Controller=void 0;var o=r(601),i=r(583),n=r(928);(t.Controller||(t.Controller={})).MainController=function(e,t){var r=this;this.self=this,this.canvasClickListener=function(e){var t=e.offsetX,s=e.offsetY;r.model.philosophers.forEach((function(e){var i=e.coords;n.inCircle(i.x,i.y,t,s,o.RADIUS_PHILOSOPHER)&&(r.model.clearPhilosopherSelection(),r.model.currentPhilosopher=e)})),r.model.currentPhilosopher&&r.model.forks.forEach((function(e,l){var a=e.coords;if(n.inCircle(a.x,a.y,t,s,o.RADIUS_FORK)){var c=r.model.currentPhilosopher.forkLeft===l,h=r.model.currentPhilosopher.forkRight===l;c?r.model.pickUpFork(i.Sides.LEFT):h&&r.model.pickUpFork(i.Sides.RIGHT),r.model.updatePhilosopherStates()}}))},this.eatButtonClickListener=function(e){r.model.startEating()},this.model=e,this.view=t}},554:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Model=void 0;var o,i,n=r(583),s=r(350),l=r(601),a=r(928);o=t.Model||(t.Model={}),i=function(){function e(){var e=this;this.observers=[],this.philosophers=[{name:"aristoteles",forkLeft:3,forkRight:2,interval:void 0,priority:1,coords:{x:0,y:0},color:a.getRandomColor(),fullness:0,isSelected:!1,state:n.States.HANGRY},{name:"seneca",forkLeft:4,forkRight:3,interval:void 0,priority:2,coords:{x:0,y:0},color:a.getRandomColor(),fullness:0,isSelected:!1,state:n.States.HANGRY},{name:"plato",forkLeft:0,forkRight:4,interval:void 0,priority:3,coords:{x:0,y:0},color:a.getRandomColor(),fullness:0,isSelected:!1,state:n.States.HANGRY},{name:"derida",forkLeft:1,forkRight:0,interval:void 0,priority:4,coords:{x:0,y:0},color:a.getRandomColor(),fullness:0,isSelected:!1,state:n.States.HANGRY},{name:"sartre",forkLeft:2,forkRight:1,interval:void 0,priority:5,coords:{x:0,y:0},color:a.getRandomColor(),fullness:0,isSelected:!1,state:n.States.HANGRY}],this.forks=[{heldBy:null,coords:{x:0,y:0},i:0},{heldBy:null,coords:{x:0,y:0},i:1},{heldBy:null,coords:{x:0,y:0},i:2},{heldBy:null,coords:{x:0,y:0},i:3},{heldBy:null,coords:{x:0,y:0},i:4}],this.pickUpFork=function(t){var r=e.currentPhilosopher,o=r.forkLeft,i=r.forkRight,l=t===n.Sides.LEFT?o:i,c=e.forks[l];if(a.logger(s.Action.PICKUP_FORK_ATTEMPT,e.currentPhilosopher,t),c.heldBy)if(e.currentPhilosopher.priority&&c.heldBy.priority&&e.currentPhilosopher.priority<c.heldBy.priority)a.logger(s.Action.PICKUP_FROM,e.currentPhilosopher,t,c),c.heldBy=e.currentPhilosopher;else{if(e.currentPhilosopher.priority===c.heldBy.priority)return void(c.heldBy=null);a.logger(s.Action.FORK_HELD,e.currentPhilosopher,t,c)}else a.logger(s.Action.PICKUP_FREE,e.currentPhilosopher,t),c.heldBy=e.currentPhilosopher;e.notifyObservers()},this.startEating=function(){if(e.currentPhilosopher.state===n.States.HOLDING_BOTH_FORKS){a.logger(s.Action.CAN_EAT,e.currentPhilosopher);var t=e.philosophers.findIndex((function(t){return e.currentPhilosopher.name===t.name}));if(-1===t)return;var r=e.philosophers[t];e.currentPhilosopher.state=n.States.EATING,e.notifyObservers(),clearInterval(r.interval),r.interval=setInterval((function(){if(e.holdingTwoForksCheck(r)&&r.fullness<3)return r.fullness++,void e.notifyObservers();clearInterval(r.interval),e.stoptEating(r)}),5e3)}else a.logger(s.Action.NO_EATING,e.currentPhilosopher)},this.stoptEating=function(t){t.state=n.States.HANGRY,e.forks[t.forkLeft].heldBy=void 0,e.forks[t.forkRight].heldBy=void 0,e.updatePhilosopherStates(),t.interval=setInterval((function(){if(t.fullness>0&&t.state!==n.States.EATING)return t.fullness--,void e.notifyObservers();clearInterval(t.interval)}),5e3)},this.addPointsToForksAndPhilosophers()}return e.prototype.clearPhilosopherSelection=function(){this.philosophers.forEach((function(e){e.isSelected=!1})),this.notifyObservers()},e.prototype.updatePhilosopherStates=function(){var e=this;this.philosophers.forEach((function(t){var r=e.holdingRightForkCheck(t),o=e.holdingLeftForkCheck(t);r&&o||t.state!==n.States.EATING||e.updatePhilosopherPriority(t),r&&o&&t.state!==n.States.EATING?t.state=n.States.HOLDING_BOTH_FORKS:o&&!r?t.state=n.States.HOLDING_LEFT_FORK:r&&!o?t.state=n.States.HOLDING_RIGHT_FORK:t.state!==n.States.EATING&&(t.state=n.States.HANGRY)})),this.notifyObservers()},e.prototype.updatePhilosopherPriority=function(e){var t=this.philosophers.reduce((function(e,t){return Math.max(e,t.priority)}),0);e.priority=t+1,this.notifyObservers()},e.prototype.registerObserver=function(e){this.observers.push(e),this.notifyObservers()},e.prototype.removeObserver=function(e){this.observers=this.observers.filter((function(t){return t!==e}))},e.prototype.notifyObservers=function(){var e=this;this.observers.forEach((function(t){return t.update(e)}))},e.prototype.addPointsToForksAndPhilosophers=function(){var e=this,t=0;this.philosophers.forEach((function(r,o){t=o*(360/e.philosophers.length);var i=l.centerX+l.R*Math.cos(a.degreesToRadians(t)),n=l.centerY+l.R*Math.sin(a.degreesToRadians(t)),s=l.centerX-(i-l.centerX),c=l.centerY-(n-l.centerY);r.coords.x=i,r.coords.y=n,e.forks[o].coords.x=s,e.forks[o].coords.y=c}))},e.prototype.holdingTwoForksCheck=function(e){return this.holdingLeftForkCheck(e)&&this.holdingRightForkCheck(e)},e.prototype.holdingRightForkCheck=function(e){return this.forks[e.forkRight].heldBy===e},e.prototype.holdingLeftForkCheck=function(e){return this.forks[e.forkLeft].heldBy===e},Object.defineProperty(e.prototype,"currentPhilosopher",{get:function(){return this._currentPhilosopher},set:function(e){e.isSelected=!0,this._currentPhilosopher=e,this.notifyObservers()},enumerable:!1,configurable:!0}),e}(),o.MainModel=i},583:(e,t)=>{var r,o;Object.defineProperty(t,"__esModule",{value:!0}),t.Sides=t.States=void 0,(o=t.States||(t.States={})).HOLDING_BOTH_FORKS="HOLDING_BOTH_FORKS",o.HOLDING_RIGHT_FORK="HOLDING_RIGHT_FORK",o.HOLDING_LEFT_FORK="HOLDING_LEFT_FORK",o.EATING="EATING",o.HANGRY="HANGRY",(r=t.Sides||(t.Sides={})).LEFT="LEFT",r.RIGHT="RIGHT"},350:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.Action=void 0,(r=t.Action||(t.Action={})).CAN_EAT="CAN_EAT 😊",r.NO_EATING="NO_EATING 🥺",r.EATING="EATING 🍔",r.PICKUP_FORK_ATTEMPT="PICKUP_FORK_ATTEMPT ⏳",r.PICKUP_FREE="PICKUP_FREE ✅",r.PICKUP_FROM="PICKUP_FROM 🔄",r.FORK_HELD="FORK_HELD ❌"},928:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getBorderColor=t.logger=t.getRandomColor=t.inCircle=t.degreesToRadians=void 0;var o=r(583),i=r(350);t.degreesToRadians=function(e){return e*(Math.PI/180)},t.inCircle=function(e,t,r,o,i){return Math.abs(e-r)<i&&Math.abs(t-o)<i},t.getRandomColor=function(){function e(){var e=Math.floor(256*Math.random()).toString(16);return("0"+String(e)).substr(-2)}return"#"+e()+e()+e()},t.logger=function(e,t,r,o){var n;i.Action.PICKUP_FORK_ATTEMPT,n=e===i.Action.PICKUP_FREE?r+" side "+t.name:o&&e===i.Action.PICKUP_FROM?r+" side "+t.name+" took from "+(o.heldBy?o.heldBy.name:""):o&&e===i.Action.FORK_HELD?r+" side held by "+(o.heldBy?o.heldBy.name:""):""+t.name,console.log(e,n)},t.getBorderColor=function(e){var t="white";if(e.isSelected)return"yellow";switch(e.state){case o.States.EATING:t="purple";break;case o.States.HOLDING_BOTH_FORKS:t="green";break;case o.States.HOLDING_LEFT_FORK:case o.States.HOLDING_RIGHT_FORK:t="pink"}return t}},55:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.View=void 0;var o,i,n,s,l=r(844),a=r(920),c=r(601),h=r(583);o=t.View||(t.View={}),i=function(){function e(){this.element=document.getElementById("myCanvas"),this.element.style.backgroundColor="grey",this.element.width=c.CANVAS_WIDTH,this.element.height=c.CANVAS_HEIGHT}return e.prototype.update=function(e){var t=this.element.getContext("2d");t.globalCompositeOperation="destination-over",l.clearCanvas(t),e.philosophers.forEach((function(r,o){a.drawPhilosopher(t,r),a.drawFork(t,e.forks[o])})),l.drawTable(t)},e.prototype.addClickEventListener=function(e){this.element.addEventListener("click",e)},e}(),n=function(){function e(){this.element=document.getElementById("eat"),this.id="eat",this.disabled=!1}return e.prototype.addClickEventListener=function(e){this.element.addEventListener("click",e)},e.prototype.update=function(e){e.currentPhilosopher&&(this.element.innerText="🍔 eat "+e.currentPhilosopher.name+" 🍔",this.id=e.currentPhilosopher.name)},e}(),s=function(){function e(){this.headers=["name","forkLeft","forkRight","fullness","priority","state"],this.element=document.getElementById("info-table")}return e.prototype.update=function(e){var t=this;this.element.innerHTML="";var r=this.createHeader();this.element.appendChild(r),e.philosophers.forEach((function(e){var r=t.createRow(e);t.element.appendChild(r)}))},e.prototype.createHeader=function(){var e=document.createElement("tr");return this.headers.forEach((function(t){var r=document.createElement("th");r.innerText=t,e.appendChild(r)})),e},e.prototype.createRow=function(e){var t=this,r=document.createElement("tr");return this.headers.forEach((function(o){var i=document.createElement("td");t.setBackgroundColor(i,e);var n=e[o];(null==n?void 0:n.toString())&&(console.log(n),i.innerText=null==n?void 0:n.toString()),r.appendChild(i)})),r},e.prototype.setBackgroundColor=function(e,t){t.state===h.States.EATING?e.style.backgroundColor="lightgreen":t.state===h.States.HANGRY?e.style.backgroundColor="lightcoral":e.style.backgroundColor="lightsalmon"},e}(),o.MainView=function(){this.canvas=new i,this.eatButton=new n,this.table=new s}}},l={};function a(e){var t=l[e];if(void 0!==t)return t.exports;var r=l[e]={exports:{}};return s[e].call(r.exports,r,r.exports,a),r.exports}o=a(1),i=a(554),n=a(55),e=new i.Model.MainModel,t=new n.View.MainView,r=new o.Controller.MainController(e,t),e.registerObserver(t.canvas),e.registerObserver(t.table),e.registerObserver(t.eatButton),t.canvas.addClickEventListener(r.canvasClickListener),t.eatButton.addClickEventListener(r.eatButtonClickListener)})();
//# sourceMappingURL=main.js.map